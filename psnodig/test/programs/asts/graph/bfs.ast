Program (Just (ProgramDescription "A set of visited nodes, a queue of nodes, a graph and a starting node" "The list of booleans")) [StructDecl "Queue" [Argument "q" "list",Argument "head" "int"]] [FunctionDecl "bfs" [Argument "visited" "set'",Argument "queue" "Queue",Argument "graph" "list",Argument "node" "int"] [CallStmt (FunctionCall "add" [VariableExp "node",VariableExp "visited"]),CallStmt (FunctionCall "append" [VariableExp "node",StructFieldExp (StructField (VariableExp "queue") (VariableExp "q"))]),Loop (BinaryExp LessThan (StructFieldExp (StructField (VariableExp "queue") (VariableExp "head"))) (CallExp (FunctionCall "length" [StructFieldExp (StructField (VariableExp "queue") (VariableExp "q"))]))) [AnnotationStmt "m $\\gets$ shift(queue)" [Assignment (VariableTarget "tmp") (ExpressionValue (CallExp (FunctionCall "shift" [VariableExp "queue"]))),Assignment (VariableTarget "queue") (ExpressionValue (ListIndex "tmp" [Constant (Number 0)])),Assignment (VariableTarget "m") (ExpressionValue (ListIndex "tmp" [Constant (Number 1)]))],ForEach "nb" (CallExp (FunctionCall "get" [VariableExp "m",VariableExp "graph"])) [If (Not (CallExp (FunctionCall "in" [VariableExp "nb",VariableExp "visited"]))) [CallStmt (FunctionCall "add" [VariableExp "nb",VariableExp "visited"]),CallStmt (FunctionCall "append" [VariableExp "nb",StructFieldExp (StructField (VariableExp "queue") (VariableExp "q"))])] Nothing]],Return (VariableExp "visited")],FunctionDecl "shift" [Argument "q" "Queue"] [Assignment (VariableTarget "val") (ExpressionValue (StructFieldExp (StructField (VariableExp "q") (ListIndex "q" [StructFieldExp (StructField (VariableExp "q") (VariableExp "head"))])))),Assignment (StructFieldTarget (StructField (VariableExp "q") (VariableExp "head"))) (ExpressionValue (BinaryExp Plus (StructFieldExp (StructField (VariableExp "q") (VariableExp "head"))) (Constant (Number 1)))),Return (Constant (List [VariableExp "q",VariableExp "val"]))]] Nothing